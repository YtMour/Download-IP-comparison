<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸‹è½½æ‹¦æˆªå™¨æµ‹è¯• v8.0</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: #fafafa;
        }
        .test-section h3 {
            color: #2c5aa0;
            margin-top: 0;
        }
        .download-link {
            display: inline-block;
            padding: 12px 24px;
            background: #007bff;
            color: white;
            text-decoration: none;
            border-radius: 6px;
            margin: 10px 10px 10px 0;
            transition: background 0.3s;
        }
        .download-link:hover {
            background: #0056b3;
        }
        .info-box {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .warning-box {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .success-box {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        .console-output {
            background: #1e1e1e;
            color: #00ff00;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            max-height: 200px;
            overflow-y: auto;
            margin: 15px 0;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-online { background: #28a745; }
        .status-offline { background: #dc3545; }
        .status-unknown { background: #ffc107; }
        
        .version-info {
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ ä¸‹è½½æ‹¦æˆªå™¨æµ‹è¯• v8.0</h1>
        
        <div class="info-box">
            <strong>ğŸ“‹ æµ‹è¯•è¯´æ˜ï¼š</strong><br>
            æœ¬é¡µé¢ç”¨äºæµ‹è¯•æ–°ç‰ˆä¸‹è½½æ‹¦æˆªå™¨çš„è‡ªåŠ¨ä¸‹è½½åŠŸèƒ½ã€‚ç‚¹å‡»ä¸‹æ–¹é“¾æ¥åº”è¯¥ï¼š
            <ul>
                <li>âœ… è‡ªåŠ¨ç”Ÿæˆä¸‹è½½å™¨ï¼ˆæ— éœ€äºŒæ¬¡ç‚¹å‡»ï¼‰</li>
                <li>âœ… æ–‡ä»¶ååŒ…å«ç‰ˆæœ¬å·</li>
                <li>âœ… å¼ºåˆ¶ç»•è¿‡æµè§ˆå™¨ç¼“å­˜</li>
                <li>âœ… æ˜¾ç¤ºæˆåŠŸæç¤º</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ¯ ç³»ç»ŸçŠ¶æ€æ£€æŸ¥</h3>
            <p><span class="status-indicator status-unknown" id="handler-status"></span>å¤„ç†å™¨çŠ¶æ€: <span id="handler-text">æ£€æŸ¥ä¸­...</span></p>
            <p><span class="status-indicator status-unknown" id="interceptor-status"></span>æ‹¦æˆªå™¨çŠ¶æ€: <span id="interceptor-text">æ£€æŸ¥ä¸­...</span></p>
            <p><span class="status-indicator status-unknown" id="backend-status"></span>æ€»åç«¯çŠ¶æ€: <span id="backend-text">æ£€æŸ¥ä¸­...</span></p>
        </div>

        <div class="test-section">
            <h3>ğŸ”— æµ‹è¯•ä¸‹è½½é“¾æ¥</h3>
            <p>ç‚¹å‡»ä»¥ä¸‹é“¾æ¥æµ‹è¯•è‡ªåŠ¨ä¸‹è½½åŠŸèƒ½ï¼š</p>
            
            <a href="https://dw.ytmour.art/windows/adobe/Photoshop_2024_v25.0.0.exe" class="download-link">
                ğŸ“¥ Adobe Photoshop 2024 v25.0.0
            </a>

            <a href="https://dw.ytmour.art/windows/games/SteamSetup.exe" class="download-link">
                ğŸ® Steam æ¸¸æˆå¹³å°
            </a>

            <a href="https://dw.ytmour.art/windows/adobe/media/PotPlayer_1.7.21564.zip" class="download-link">
                ğŸ¬ PotPlayer v1.7.21564
            </a>

            <a href="https://dw.ytmour.art/windows/adobe/office/Office_2024_Professional.msi" class="download-link">
                ğŸ“„ Microsoft Office 2024 Professional
            </a>
        </div>

        <div class="test-section">
            <h3>ğŸ” å®æ—¶æ—¥å¿—</h3>
            <div class="console-output" id="console-log">
                ç­‰å¾…æ“ä½œ...
            </div>
            <button onclick="clearLog()" style="margin-top: 10px; padding: 8px 16px;">æ¸…ç©ºæ—¥å¿—</button>
        </div>

        <div class="warning-box">
            <strong>âš ï¸ æ³¨æ„äº‹é¡¹ï¼š</strong><br>
            1. ç¡®ä¿å·²æ¸…ç†æµè§ˆå™¨ç¼“å­˜ï¼ˆCtrl+F5ï¼‰<br>
            2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·æŸ¥çœ‹è¯¦ç»†æ—¥å¿—<br>
            3. æ£€æŸ¥æµè§ˆå™¨ä¸‹è½½æ–‡ä»¶å¤¹ä¸­çš„æ–‡ä»¶åæ ¼å¼<br>
            4. å¦‚æœä»æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒã€Šå®å¡”é¢æ¿ç¼“å­˜æ¸…ç†æŒ‡å—.mdã€‹
        </div>

        <div class="success-box" style="display: none;" id="success-info">
            <strong>âœ… æµ‹è¯•æˆåŠŸï¼</strong><br>
            <span id="success-details"></span>
        </div>

        <div class="version-info">
            æ‹¦æˆªå™¨ç‰ˆæœ¬: v8.0 | æµ‹è¯•é¡µé¢ç‰ˆæœ¬: v1.0 | æ›´æ–°æ—¶é—´: <?php echo date('Y-m-d H:i:s'); ?>
        </div>
    </div>

    <!-- åŠ è½½æ‹¦æˆªå™¨ï¼Œæ·»åŠ ç‰ˆæœ¬å‚æ•°é˜²æ­¢ç¼“å­˜ -->
    <script src="interceptor.js?v=8.0&t=<?php echo time(); ?>"></script>
    
    <script>
        // æ—¥å¿—åŠŸèƒ½
        const logElement = document.getElementById('console-log');
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logLine = `[${timestamp}] ${message}`;
            
            const logDiv = document.createElement('div');
            logDiv.textContent = logLine;
            logDiv.style.color = type === 'error' ? '#ff6b6b' : '#00ff00';
            
            logElement.appendChild(logDiv);
            logElement.scrollTop = logElement.scrollHeight;
        }
        
        function clearLog() {
            logElement.innerHTML = 'æ—¥å¿—å·²æ¸…ç©º...';
        }
        
        // é‡å†™console.logä»¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸Š
        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            addLog(args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            addLog('ERROR: ' + args.join(' '), 'error');
        };
        
        // é¡µé¢åŠ è½½å®Œæˆåæ£€æŸ¥çŠ¶æ€
        document.addEventListener('DOMContentLoaded', function() {
            addLog('é¡µé¢åŠ è½½å®Œæˆï¼Œå¼€å§‹æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...');
            checkSystemStatus();
        });
        
        async function checkSystemStatus() {
            // æ£€æŸ¥å¤„ç†å™¨çŠ¶æ€
            try {
                const response = await fetch('./handler.php?action=stats');
                const result = await response.json();
                
                if (result.success) {
                    updateStatus('handler', 'online', 'æ­£å¸¸è¿è¡Œ');
                    addLog('âœ… å¤„ç†å™¨çŠ¶æ€æ­£å¸¸');
                } else {
                    updateStatus('handler', 'offline', 'å“åº”å¼‚å¸¸');
                    addLog('âŒ å¤„ç†å™¨å“åº”å¼‚å¸¸: ' + result.message);
                }
            } catch (error) {
                updateStatus('handler', 'offline', 'è¿æ¥å¤±è´¥');
                addLog('âŒ å¤„ç†å™¨è¿æ¥å¤±è´¥: ' + error.message);
            }
            
            // æ£€æŸ¥æ‹¦æˆªå™¨çŠ¶æ€
            if (window.downloadInterceptor) {
                updateStatus('interceptor', 'online', 'v8.0 å·²åŠ è½½');
                addLog('âœ… æ‹¦æˆªå™¨ v8.0 å·²åŠ è½½');
            } else {
                updateStatus('interceptor', 'offline', 'æœªåŠ è½½');
                addLog('âŒ æ‹¦æˆªå™¨æœªåŠ è½½');
            }
            
            // æ£€æŸ¥æ€»åç«¯çŠ¶æ€ï¼ˆé€šè¿‡å¤„ç†å™¨ï¼‰
            updateStatus('backend', 'unknown', 'é€šè¿‡å¤„ç†å™¨æ£€æŸ¥');
            addLog('â„¹ï¸ æ€»åç«¯çŠ¶æ€å°†åœ¨é¦–æ¬¡ä¸‹è½½æ—¶æ£€æŸ¥');
        }
        
        function updateStatus(component, status, text) {
            const statusElement = document.getElementById(component + '-status');
            const textElement = document.getElementById(component + '-text');
            
            statusElement.className = 'status-indicator status-' + status;
            textElement.textContent = text;
        }
        
        // ç›‘å¬ä¸‹è½½æˆåŠŸäº‹ä»¶
        document.addEventListener('click', function(e) {
            if (e.target.classList.contains('download-link')) {
                const softwareName = e.target.textContent.trim();
                addLog('ğŸ¯ ç‚¹å‡»ä¸‹è½½: ' + softwareName);
                
                // 3ç§’åæ£€æŸ¥æ˜¯å¦æˆåŠŸ
                setTimeout(() => {
                    const successInfo = document.getElementById('success-info');
                    const successDetails = document.getElementById('success-details');
                    
                    successDetails.innerHTML = `
                        è½¯ä»¶åç§°: ${softwareName}<br>
                        é¢„æœŸæ–‡ä»¶åæ ¼å¼: ${softwareName.replace(/[^\w\s-]/g, '').replace(/\s+/g, '_')}_v${new Date().getFullYear()}${String(new Date().getMonth() + 1).padStart(2, '0')}${String(new Date().getDate()).padStart(2, '0')}_*.zip<br>
                        è¯·æ£€æŸ¥æµè§ˆå™¨ä¸‹è½½æ–‡ä»¶å¤¹
                    `;
                    successInfo.style.display = 'block';
                }, 3000);
            }
        });
        
        addLog('ğŸš€ æµ‹è¯•é¡µé¢åˆå§‹åŒ–å®Œæˆ');
    </script>
</body>
</html>
